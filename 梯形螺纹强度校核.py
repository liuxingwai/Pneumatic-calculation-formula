# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file '梯形螺纹强度校核.ui'
#
# Created by: PyQt5 UI code generator 5.15.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QMainWindow,QMessageBox
from PyQt5.QtWidgets import QTableWidgetItem
import numpy as np
import sqlite3
import datetime
from sqlite3 import Error

#连接数据库
def sql_connection():
    try:
        con = sqlite3.connect("梯形螺纹强度校核数据库.db")
        return con
    except Error:
        print(Error)
#创建表
def sql_table(con):
    try:
        # 创建游标
        cursor = con.cursor()
        cursor.execute("create table 梯形螺纹挤压应力 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用拉应力σ,挤压应力σp,合格判据)")
        cursor.execute("create table 梯形螺纹剪切应力 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用剪应力τ,剪切应力τ,合格判据)")
        cursor.execute("create table 梯形螺纹弯曲应力 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用弯曲应力σb,弯曲应力σb,合格判据")
        cursor.execute( "create table 梯形螺纹螺杆强度 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用应力σ,螺杆强度σ,自锁性)")
        # 提交事务
        con.commit()
    except Error:
        print("Error")
con = sql_connection()
sql_table(con)


class Ui_tixingluowenqiangdu(QMainWindow):
    def setupUi(self, tixingluowenqiangdu):
        tixingluowenqiangdu.setObjectName("tixingluowenqiangdu")
        tixingluowenqiangdu.resize(705, 720)
        tixingluowenqiangdu.setMaximumSize(QtCore.QSize(705, 720))
        font = QtGui.QFont()
        font.setFamily("楷体")
        font.setPointSize(20)
        tixingluowenqiangdu.setFont(font)
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(":/PNG/chengliang.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        tixingluowenqiangdu.setWindowIcon(icon)
        tixingluowenqiangdu.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.label = QtWidgets.QLabel(tixingluowenqiangdu)
        self.label.setGeometry(QtCore.QRect(120, 30, 140, 30))
        font = QtGui.QFont()
        font.setFamily("楷体")
        font.setPointSize(20)
        font.setBold(False)
        font.setWeight(50)
        self.label.setFont(font)
        self.label.setStyleSheet("background-color: rgb(11, 182, 255);")
        self.label.setAlignment(QtCore.Qt.AlignCenter)
        self.label.setObjectName("label")
        self.tableWidget = QtWidgets.QTableWidget(tixingluowenqiangdu)
        self.tableWidget.setGeometry(QtCore.QRect(30, 80, 310, 570))
        self.tableWidget.setObjectName("tableWidget")
        self.tableWidget.setColumnCount(2)
        self.tableWidget.setRowCount(18)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(12, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(13, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(14, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(15, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(16, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(17, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(4, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(5, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(6, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(7, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(8, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(9, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(10, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(11, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(12, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(13, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(14, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(15, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(16, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setItem(17, 0, item)

        # 固定列
        for i in range(self.tableWidget.rowCount()+1):
            self.tableWidget.setItem(i-1, 0, item)
            item = QtWidgets.QTableWidgetItem()
            item.setFlags(
                QtCore.Qt.ItemIsSelectable | QtCore.Qt.ItemIsEditable | QtCore.Qt.ItemIsDragEnabled | QtCore.Qt.ItemIsDropEnabled | QtCore.Qt.ItemIsUserCheckable)
        for j in [3, 4, 5, 6, 7, 10, 11, 15, 17]:
            self.tableWidget.setItem(j, 1, item)
            item = QtWidgets.QTableWidgetItem()
            item.setFlags(
                QtCore.Qt.ItemIsSelectable | QtCore.Qt.ItemIsEditable | QtCore.Qt.ItemIsDragEnabled | QtCore.Qt.ItemIsDropEnabled | QtCore.Qt.ItemIsUserCheckable)
        for k in [0, 1, 2, 3, 9, 10,13, 14, 15, 17]:
            self.tableWidget.setItem(k-1, 1, item)
            item = QtWidgets.QTableWidgetItem()
            brush = QtGui.QBrush(QtGui.QColor(85, 255, 255))
            brush.setStyle(QtCore.Qt.SolidPattern)
            item.setBackground(brush)
            brush = QtGui.QBrush(QtGui.QColor(0, 0, 0))
            brush.setStyle(QtCore.Qt.NoBrush)
            item.setForeground(brush)

        self.tableWidget_2 = QtWidgets.QTableWidget(tixingluowenqiangdu)
        self.tableWidget_2.setGeometry(QtCore.QRect(360, 80, 310, 390))
        self.tableWidget_2.setObjectName("tableWidget_2")
        self.tableWidget_2.setColumnCount(2)
        self.tableWidget_2.setRowCount(12)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setVerticalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(4, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(5, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(6, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(7, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(8, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(9, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(10, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setItem(11, 0, item)
        self.tableWidget_2.setEnabled(False)
        self.pushButton = QtWidgets.QPushButton(tixingluowenqiangdu)
        self.pushButton.setGeometry(QtCore.QRect(440, 30, 140, 30))
        font = QtGui.QFont()
        font.setFamily("楷体")
        font.setPointSize(20)
        self.pushButton.setFont(font)
        self.pushButton.setStyleSheet("background-color: rgb(11, 182, 255);")
        self.pushButton.setObjectName("pushButton")
        self.label_1 = QtWidgets.QLabel(tixingluowenqiangdu)
        self.label_1.setGeometry(QtCore.QRect(360, 500, 310, 100))
        font = QtGui.QFont()
        font.setFamily("楷体")
        font.setPointSize(12)
        font.setBold(False)
        font.setWeight(50)
        self.label_1.setFont(font)
        self.label_1.setStyleSheet("background-color: rgb(11, 182, 255);")
        self.label_1.setAlignment(QtCore.Qt.AlignLeft)
        self.label_1.setObjectName("label")

        self.retranslateUi(tixingluowenqiangdu)
        QtCore.QMetaObject.connectSlotsByName(tixingluowenqiangdu)

        # 设置列宽
        self.tableWidget.setColumnWidth(0, 60)
        self.tableWidget.setColumnWidth(1, 150)
        self.tableWidget_2.setColumnWidth(0, 60)
        self.tableWidget_2.setColumnWidth(1, 140)

        self.pushButton.clicked.connect(self.jisuan)

    def retranslateUi(self, tixingluowenqiangdu):
        _translate = QtCore.QCoreApplication.translate
        tixingluowenqiangdu.setWindowTitle(_translate("tixingluowenqiangdu", "梯形螺纹强度校核1.0 By ChengLiang"))
        self.label.setText(_translate("tixingluowenqiangdu", "原始条件"))
        self.label_1.setText(_translate("putongluowenqiangdu", "\n"
                                                               "对塑性材料，最小许用安全系数[S]：\n"
                                                               "σs/σb:0.45～0.55, [S]取1.2～1.5;\n"
                                                               "σs/σb:0.55～0.70, [S]取1.4～1.8;\n"
                                                               "σs/σb:0.70～0.90, [S]取1.7～2.2。"))
        item = self.tableWidget.verticalHeaderItem(0)
        item.setText(_translate("tixingluowenqiangdu", "公称直径D"))
        item = self.tableWidget.verticalHeaderItem(1)
        item.setText(_translate("tixingluowenqiangdu", "螺距p"))
        item = self.tableWidget.verticalHeaderItem(2)
        item.setText(_translate("tixingluowenqiangdu", "轴向力F"))
        item = self.tableWidget.verticalHeaderItem(3)
        item.setText(_translate("tixingluowenqiangdu", "螺纹小径d1"))
        item = self.tableWidget.verticalHeaderItem(4)
        item.setText(_translate("tixingluowenqiangdu", "螺纹中径d2"))
        item = self.tableWidget.verticalHeaderItem(5)
        item.setText(_translate("tixingluowenqiangdu", "螺纹牙底宽度b"))
        item = self.tableWidget.verticalHeaderItem(6)
        item.setText(_translate("tixingluowenqiangdu", "螺纹工作高度h"))
        item = self.tableWidget.verticalHeaderItem(7)
        item.setText(_translate("tixingluowenqiangdu", "螺旋升角ψ"))
        item = self.tableWidget.verticalHeaderItem(8)
        item.setText(_translate("tixingluowenqiangdu", "牙型倾角β"))
        item = self.tableWidget.verticalHeaderItem(9)
        item.setText(_translate("tixingluowenqiangdu", "摩擦系数f"))
        item = self.tableWidget.verticalHeaderItem(10)
        item.setText(_translate("tixingluowenqiangdu", "当量摩擦系数fv"))
        item = self.tableWidget.verticalHeaderItem(11)
        item.setText(_translate("tixingluowenqiangdu", "当量摩擦角ψv"))
        item = self.tableWidget.verticalHeaderItem(12)
        item.setText(_translate("tixingluowenqiangdu", "螺纹圈数z"))
        item = self.tableWidget.verticalHeaderItem(13)
        item.setText(_translate("tixingluowenqiangdu", "屈服强度σs"))
        item = self.tableWidget.verticalHeaderItem(14)
        item.setText(_translate("tixingluowenqiangdu", "极限强度σb"))
        item = self.tableWidget.verticalHeaderItem(15)
        item.setText(_translate("tixingluowenqiangdu", "σs/σb"))
        item = self.tableWidget.verticalHeaderItem(16)
        item.setText(_translate("tixingluowenqiangdu", "安全系数S"))
        item = self.tableWidget.verticalHeaderItem(17)
        item.setText(_translate("tixingluowenqiangdu", "许用拉应力[σ]"))
        item = self.tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("tixingluowenqiangdu", "单位"))
        item = self.tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("tixingluowenqiangdu", "数据"))
        __sortingEnabled = self.tableWidget.isSortingEnabled()
        self.tableWidget.setSortingEnabled(False)
        item = self.tableWidget.item(0, 0)
        item.setText(_translate("tixingluowenqiangdu", "mm"))
        item = self.tableWidget.item(1, 0)
        item.setText(_translate("tixingluowenqiangdu", "mm"))
        item = self.tableWidget.item(2, 0)
        item.setText(_translate("tixingluowenqiangdu", "N"))
        item = self.tableWidget.item(3, 0)
        item.setText(_translate("tixingluowenqiangdu", "mm"))
        item = self.tableWidget.item(4, 0)
        item.setText(_translate("tixingluowenqiangdu", "mm"))
        item = self.tableWidget.item(5, 0)
        item.setText(_translate("tixingluowenqiangdu", "mm"))
        item = self.tableWidget.item(6, 0)
        item.setText(_translate("tixingluowenqiangdu", "mm"))
        item = self.tableWidget.item(7, 0)
        item.setText(_translate("tixingluowenqiangdu", "deg"))
        item = self.tableWidget.item(8, 0)
        item.setText(_translate("tixingluowenqiangdu", "deg"))
        item = self.tableWidget.item(9, 0)
        item.setText(_translate("tixingluowenqiangdu", "无量纲"))
        item = self.tableWidget.item(10, 0)
        item.setText(_translate("tixingluowenqiangdu", "无量纲"))
        item = self.tableWidget.item(11, 0)
        item.setText(_translate("tixingluowenqiangdu", "deg"))
        item = self.tableWidget.item(12, 0)
        item.setText(_translate("tixingluowenqiangdu", "无量纲"))
        item = self.tableWidget.item(13, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget.item(14, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget.item(15, 0)
        item.setText(_translate("tixingluowenqiangdu", "无量纲"))
        item = self.tableWidget.item(16, 0)
        item.setText(_translate("tixingluowenqiangdu", "无量纲"))
        item = self.tableWidget.item(17, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        self.tableWidget.setSortingEnabled(__sortingEnabled)
        item = self.tableWidget_2.verticalHeaderItem(0)
        item.setText(_translate("tixingluowenqiangdu", "螺纹摩擦力矩Mt1"))
        item = self.tableWidget_2.verticalHeaderItem(1)
        item.setText(_translate("tixingluowenqiangdu", "挤压应力σp"))
        item = self.tableWidget_2.verticalHeaderItem(2)
        item.setText(_translate("tixingluowenqiangdu", "σp<[σp]"))
        item = self.tableWidget_2.verticalHeaderItem(3)
        item.setText(_translate("tixingluowenqiangdu", "许用剪应力[τ]"))
        item = self.tableWidget_2.verticalHeaderItem(4)
        item.setText(_translate("tixingluowenqiangdu", "剪切应力τ"))
        item = self.tableWidget_2.verticalHeaderItem(5)
        item.setText(_translate("tixingluowenqiangdu", "τ<[τ]"))
        item = self.tableWidget_2.verticalHeaderItem(6)
        item.setText(_translate("tixingluowenqiangdu", "[σb]"))
        item = self.tableWidget_2.verticalHeaderItem(7)
        item.setText(_translate("tixingluowenqiangdu", "弯曲应力σb"))
        item = self.tableWidget_2.verticalHeaderItem(8)
        item.setText(_translate("tixingluowenqiangdu", "σb<[σb]"))
        item = self.tableWidget_2.verticalHeaderItem(9)
        item.setText(_translate("tixingluowenqiangdu", "螺杆强度σ"))
        item = self.tableWidget_2.verticalHeaderItem(10)
        item.setText(_translate("tixingluowenqiangdu", "螺杆强度σ<[σ]"))
        item = self.tableWidget_2.verticalHeaderItem(11)
        item.setText(_translate("tixingluowenqiangdu", "自锁性"))
        item = self.tableWidget_2.horizontalHeaderItem(0)
        item.setText(_translate("tixingluowenqiangdu", "单位"))
        item = self.tableWidget_2.horizontalHeaderItem(1)
        item.setText(_translate("tixingluowenqiangdu", "数据"))
        __sortingEnabled = self.tableWidget_2.isSortingEnabled()
        self.tableWidget_2.setSortingEnabled(False)
        item = self.tableWidget_2.item(0, 0)
        item.setText(_translate("tixingluowenqiangdu", "N·m"))
        item = self.tableWidget_2.item(1, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget_2.item(2, 0)
        item.setText(_translate("tixingluowenqiangdu", "?"))
        item = self.tableWidget_2.item(3, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget_2.item(4, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget_2.item(5, 0)
        item.setText(_translate("tixingluowenqiangdu", "?"))
        item = self.tableWidget_2.item(6, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget_2.item(7, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget_2.item(8, 0)
        item.setText(_translate("tixingluowenqiangdu", "?"))
        item = self.tableWidget_2.item(9, 0)
        item.setText(_translate("tixingluowenqiangdu", "MPa"))
        item = self.tableWidget_2.item(10, 0)
        item.setText(_translate("tixingluowenqiangdu", "?"))
        item = self.tableWidget_2.item(11, 0)
        item.setText(_translate("tixingluowenqiangdu", "?"))
        self.tableWidget_2.setSortingEnabled(__sortingEnabled)
        self.pushButton.setText(_translate("tixingluowenqiangdu", "计算结果"))

    def canshu(self):
        global D,p,F,d1,d2,b,h,ψ,β,f,fv,ψv,z,σs,σb,n,S,σ,Mt1,σp,σp1,τ,s,s1,τ1,τ2,σb1,G,σb2,σb3,σ3,qd,zs
        D = self.tableWidget.item(0, 1).text()
        p = self.tableWidget.item(1, 1).text()
        F = self.tableWidget.item(2, 1).text()
        d1 = self.tableWidget.item(3, 1).text()
        d2 = self.tableWidget.item(4, 1).text()
        b = self.tableWidget.item(5, 1).text()
        h = self.tableWidget.item(6, 1).text()
        ψ= self.tableWidget.item(7, 1).text()
        β = self.tableWidget.item(8, 1).text()
        f = self.tableWidget.item(9, 1).text()
        fv = self.tableWidget.item(10, 1).text()
        ψv = self.tableWidget.item(11, 1).text()
        z = self.tableWidget.item(12, 1).text()
        σs = self.tableWidget.item(13, 1).text()
        σb = self.tableWidget.item(14, 1).text()
        n=self.tableWidget.item(15, 1).text()
        S= self.tableWidget.item(16, 1).text()
        σ= self.tableWidget.item(17, 1).text()

    def jisuan(self):
        global D, p, F, d1, d2, b, h, ψ, β, f, fv, ψv, z, σs, σb, n, S, σ, Mt1, σp, σp1, τ, s, s1, τ1, τ2, σb1, G, σb2, σb3, σ3, qd, zs
        self.canshu()
        if D == None or p == None or F == None or D == "" or p == "" or F == "" or float(D) <= 0 or float(
                F) < 0 or float(p) <= 0:
            QMessageBox.information(None, "使用提示", "公称直径、螺距、轴向力计算数据不完整或错误，请检查后重新输入！", QMessageBox.Ok)
        else:
            D = float(D)
            p = float(p)
            F = float(F)
            d1 = D - p
            self.tableWidget.setItem(3, 1, QTableWidgetItem(str(d1)))
            d2 = D - 0.5 * p
            self.tableWidget.setItem(4, 1, QTableWidgetItem(str(d2)))
            b = p * 0.634
            self.tableWidget.setItem(5, 1, QTableWidgetItem(str(b)))
            h = 0.5 * p
            self.tableWidget.setItem(6, 1, QTableWidgetItem(str(h)))
            ψ = np.tan(p / (d2 * np.pi)) * 180 / np.pi
            self.tableWidget.setItem(7, 1, QTableWidgetItem(str(ψ)))
            if β == None or f == None or β == "" or f == "" or float(β) <= 0 or float(f) <= 0:
                QMessageBox.information(None, "使用提示", "牙型倾角、摩擦系数计算数据不完整或错误，请检查后重新输入！", QMessageBox.Ok)
            else:
                β = float(β)
                f = float(f)
                fv = f / np.cos(β * np.pi / 180)
                self.tableWidget.setItem(10, 1, QTableWidgetItem(str(fv)))
                ψv = np.tan(fv) * 180 / np.pi
                self.tableWidget.setItem(11, 1, QTableWidgetItem(str(ψv)))
                if z == None or σs == None or σb== None or z == "" or σs == "" or σb == "" or float(z) <= 0 or float(σb) < 0 or float(σs) <= 0:
                    QMessageBox.information(None, "使用提示", "螺纹圈数、屈服强度、极限强度计算数据不完整或错误，请检查后重新输入！", QMessageBox.Ok)
                else:
                    z = float(z)
                    σs = float(σs)
                    σb = float(σb)
                    n = σs / σb
                    self.tableWidget.setItem(15, 1, QTableWidgetItem(str(n)))
                    if S==None or S=="" or float(S)<=0:
                        QMessageBox.information(None, "使用提示", "安全系数计算数据不完整或错误，请检查后重新输入！", QMessageBox.Ok)
                    else:
                        S = float(S)
                        σ = σs / S
                        self.tableWidget.setItem(17, 1, QTableWidgetItem(str(σ)))
                        Mt1 = 0.5 * d2 * F * np.tan((ψ + ψv) * np.pi / 180) / 1000
                        self.tableWidget_2.setItem(0, 1, QTableWidgetItem(str(Mt1)))
                        σp = round(F / (np.pi * d2 * h * z),5)
                        self.tableWidget_2.setItem(1, 1, QTableWidgetItem(str(σp)))
                        if σp < σ:
                            self.tableWidget_2.setItem(2, 1, QTableWidgetItem("抗挤压：合格"))
                            self.shuju1()
                        else:
                            self.tableWidget_2.setItem(2, 1, QTableWidgetItem("抗挤压：不合格"))
                            self.shuju1()
                        τ = 0.6 * σ
                        self.tableWidget_2.setItem(3, 1, QTableWidgetItem(str(τ)))
                        τ1 = round(F / (np.pi * d1 * b * z),5)
                        self.tableWidget_2.setItem(4, 1, QTableWidgetItem(str(τ1)))
                        if τ1 < τ:
                            self.tableWidget_2.setItem(5, 1, QTableWidgetItem("抗剪切：合格"))
                            self.shuju2()
                        else:
                            self.tableWidget_2.setItem(5, 1, QTableWidgetItem("抗剪切：不合格"))
                            self.shuju2()
                        σb1 = σ
                        self.tableWidget_2.setItem(6, 1, QTableWidgetItem(str(σb1)))
                        σb2 = round(3 * F * h / (np.pi * d1 * z * np.power(b, 2)),5)
                        self.tableWidget_2.setItem(7, 1, QTableWidgetItem(str(σb2)))
                        if σb2 < σb1:
                            self.tableWidget_2.setItem(8, 1, QTableWidgetItem("抗弯曲：合格"))
                            self.shuju3()
                        else:
                            self.tableWidget_2.setItem(8, 1, QTableWidgetItem("抗弯曲：不合格"))
                            self.shuju3()
                        σ3 = round(F / (np.pi / 4 * np.power(d1, 2)),5)
                        self.tableWidget_2.setItem(9, 1, QTableWidgetItem(str(σ3)))
                        if σ3 < σ:
                            self.tableWidget_2.setItem(10, 1, QTableWidgetItem("螺杆强度：合格"))
                        else:
                            self.tableWidget_2.setItem(10, 1, QTableWidgetItem("螺杆强度：不合格"))
                        if ψ < ψv:
                            self.tableWidget_2.setItem(11, 1, QTableWidgetItem("自锁性：满足"))
                        else:
                            self.tableWidget_2.setItem(11, 1, QTableWidgetItem("自锁性：不满足"))
                        self.shuju4()

    def datetime(self):
        global now_time
        now_time= datetime.datetime.now().strftime("%Y.%m.%d %H:%M:%S")

    def shuju1(self):
        self.datetime()
        σp = self.tableWidget_2.item(1, 1).text()
        σp1 = str(self.tableWidget_2.item(2, 1).text())
        def sql_insert(con, data):
                cursor = con.cursor()
                cursor.execute("insert into 梯形螺纹挤压应力 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用拉应力σ,挤压应力σp,合格判据) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",data)
                con.commit()
        data = (now_time,D, p, F, d1, d2, b, h, ψ, β, f, fv, ψv, z, σs, σb, S, σ, σp, σp1)
        sql_insert(con, data)
    def shuju2(self):
        self.datetime()
        τ = self.tableWidget_2.item(3, 1).text()
        τ1 = self.tableWidget_2.item(4, 1).text()
        τ2 = str(self.tableWidget_2.item(5, 1).text())
        def sql_insert(con, data):
                cursor = con.cursor()
                cursor.execute("insert into 梯形螺纹剪切应力 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用剪应力τ,剪切应力τ,合格判据) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",data)
                con.commit()
        data = (now_time,D, p, F, d1, d2, b, h, ψ, β, f, fv, ψv, z, σs, σb, S, τ, τ1, τ2)
        sql_insert(con, data)
    def shuju3(self):
        self.datetime()
        σb1 = self.tableWidget_2.item(6, 1).text()
        σb2 = self.tableWidget_2.item(7, 1).text()
        σb3 = str(self.tableWidget_2.item(8, 1).text())
        def sql_insert(con, data):
                cursor = con.cursor()
                cursor.execute("insert into 梯形螺纹弯曲应力 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用弯曲应力σb,弯曲应力σb,合格判据) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",data)
                con.commit()
        data = (now_time,D, p, F, d1, d2, b, h, ψ, β, f, fv, ψv, z, σs, σb, S, σb1, σb2, σb3)
        sql_insert(con, data)
    def shuju4(self):
        self.datetime()
        σ3 = self.tableWidget_2.item(9, 1).text()
        qd = str(self.tableWidget_2.item(10, 1).text())
        zs = str(self.tableWidget_2.item(11, 1).text())
        def sql_insert(con, data):
                cursor = con.cursor()
                cursor.execute("insert into 梯形螺纹螺杆强度 (日期,公称直径D,螺距p,轴向力F,螺纹小径d1,螺纹中径d2,螺纹牙底宽度b,螺纹工作高度h,螺旋升角ψ,牙型倾角β,摩擦系数f,当量摩擦系数fv,当量摩擦角ψv,螺纹圈数z,屈服强度σs,极限强度σb,安全系数S,许用应力σ,螺杆强度σ,自锁性) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",data)
                con.commit()
        data = (now_time,D, p, F, d1, d2, b, h, ψ, β, f, fv, ψv, z, σs, σb, S, σ3, qd, zs)
        sql_insert(con, data)

import img_rc

import sys
if __name__ == '__main__':
    app = QtWidgets.QApplication(sys.argv)
    Mainwidow = QtWidgets.QMainWindow()  # 创建窗体对象
    ui = Ui_tixingluowenqiangdu()  # 创建QT设计的窗体
    ui.setupUi(Mainwidow)  # 初始化设置
    Mainwidow.show()  # 显示窗体
    sys.exit(app.exec_())  # 程序关闭时退出进程